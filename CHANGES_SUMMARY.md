# üìä –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Å—Ç–∞–≤–∞–ª—Å—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–æ–≥–æ —è–∑—ã–∫–∞.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª—å—é —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–æ–≤.

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `lib/providers/locale_provider.dart`
**–ë—ã–ª–æ:**
```dart
class LocaleProvider extends ChangeNotifier {
  Locale _locale = const Locale('ru');
  // notifyListeners() –≤—ã–∑—ã–≤–∞–ª—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ loadLocale()
}
```

**–°—Ç–∞–ª–æ:**
```dart
class LocaleProvider extends ChangeNotifier {
  Locale? _locale;
  bool _isInitialized = false;
  // –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ —É–º–Ω–∞—è —Å–º–µ–Ω–∞ –ª–æ–∫–∞–ª–∏
  Future<void> setLocale(Locale locale) async {
    if (_locale == locale) return; // –ò–∑–±–µ–≥–∞–µ–º –ª–∏—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤
    _locale = locale;
    await prefs.setString('app_locale', locale.languageCode);
    notifyListeners();
  }
}
```

### 2. `lib/main.dart`
**–ë—ã–ª–æ:**
```dart
class _MyAppState extends State<MyApp> {
  final _localeProvider = LocaleProvider();
  bool _isLoading = true;
  // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å loading —ç–∫—Ä–∞–Ω–æ–º
}
```

**–°—Ç–∞–ª–æ:**
```dart
void main() async {
  final localeProvider = LocaleProvider();
  await localeProvider.loadLocale(); // –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ main()
  
  runApp(MyApp(localeProvider: localeProvider));
}

class MyApp extends StatelessWidget {
  final LocaleProvider localeProvider;
  // –£–±—Ä–∞–ª–∏ _isLoading, MaterialApp —Å—Ä–∞–∑—É –≥–æ—Ç–æ–≤
}
```

### 3. `lib/screens/language_settings_screen.dart`
**–ë—ã–ª–æ:**
```dart
class LanguageSettingsScreen extends StatelessWidget {
  // –ü—Ä–æ—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª–∏ –±–µ–∑ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
  onTap: () => context.read<LocaleProvider>().setLocale(Locale(...));
}
```

**–°—Ç–∞–ª–æ:**
```dart
class LanguageSettingsScreen extends StatefulWidget {
  // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
  Future<void> _changeLanguage(String languageCode) async {
    setState(() => _isUpdating = true);
    
    await localeProvider.setLocale(newLocale);
    
    ScaffoldMessenger.showSnackBar(...); // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    Navigator.of(context).pop(); // –ó–∞–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω
  }
}
```

### 4. `lib/screens/main_screen.dart`
**–ë—ã–ª–æ:**
```dart
items: const [
  BottomNavigationBarItem(label: '–ì–ª–∞–≤–Ω–∞—è'), // –ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–æ
  BottomNavigationBarItem(label: '–ê–≤—Ç–æ'),
]
```

**–°—Ç–∞–ª–æ:**
```dart
items: [
  BottomNavigationBarItem(
    label: l10n?.dashboardTitle ?? '–ì–ª–∞–≤–Ω–∞—è', // –õ–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–æ
  ),
  // –í—Å–µ –ø—É–Ω–∫—Ç—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω—ã
]
```

### 5. `lib/l10n/app_localizations.dart`
**–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∫–ª—é—á–∏:**
- `'dashboardTitle': '–ì–ª–∞–≤–Ω–∞—è' / 'Home' / '–ë–∞—Å—Ç—ã –±–µ—Ç'`
- `'mapTitle': '–ö–∞—Ä—Ç–∞' / 'Map' / '–ö–∞—Ä—Ç–∞'`

## üé® –í–∏–∑—É–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ —è–∑—ã–∫–∞:
```dart
body: _isUpdating
  ? Center(child: Column(
      children: [
        CircularProgressIndicator(),
        Text('–ü—Ä–∏–º–µ–Ω—è–µ–º —è–∑—ã–∫...'),
      ],
    ))
  : ListView.builder(...);
```

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ:
```dart
ScaffoldMessenger.of(context).showSnackBar(
  SnackBar(content: Text('–Ø–∑—ã–∫ –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ ${languageName}')),
);
```

## üß™ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç:
```bash
dart run language_switch_test.dart
```

### –†—É—á–Ω–æ–π —Ç–µ—Å—Ç:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –Ø–∑—ã–∫ ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ "“ö–∞–∑–∞“õ—à–∞"
3. –ù–∞–∂–º–∏—Ç–µ "OK" - —É–≤–∏–¥–∏—Ç–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
4. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ –≥–ª–∞–≤–Ω—É—é - –≤–µ—Å—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–æ–º
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ - —è–∑—ã–∫ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** - LocaleProvider –≥–æ—Ç–æ–≤ –¥–æ UI
2. **Reactive UI** - Consumer –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç MaterialApp
3. **Fail-safe** - –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã ‚Üí —Ä—É—Å—Å–∫–∏–π
4. **User feedback** - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
5. **Persistence** - SharedPreferences –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ** - –Ω–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏** - —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –≤–∏–¥–∂–µ—Ç—ã
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∫–µ—à–∏—Ä—É–µ—Ç—Å—è –≤ Map
- **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –ø–µ—Ä–µ–≤–æ–¥—ã –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é

## üåç –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —è–∑—ã–∫–æ–≤

| –Ø–∑—ã–∫ | –ö–æ–¥ | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ |
|------|-----|--------|------------------|
| üá∑üá∫ –†—É—Å—Å–∫–∏–π | ru | ‚úÖ –ü–æ–ª–Ω—ã–π | –ì–ª–∞–≤–Ω–∞—è, –ö–∞—Ä—Ç–∞, –ü—Ä–æ—Ñ–∏–ª—å |
| üá¨üáß –ê–Ω–≥–ª–∏–π—Å–∫–∏–π | en | ‚úÖ –ü–æ–ª–Ω—ã–π | Home, Map, Profile |
| üá∞üáø –ö–∞–∑–∞—Ö—Å–∫–∏–π | kk | ‚úÖ –ü–æ–ª–Ω—ã–π | –ë–∞—Å—Ç—ã –±–µ—Ç, –ö–∞—Ä—Ç–∞, –ü—Ä–æ—Ñ–∏–ª—å |

---

**‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–µ–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—ã–±–æ—Ä–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–æ–≤ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
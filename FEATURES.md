# ServiceBook - Функциональность приложения

## Обзор

ServiceBook — это приложение для ведения истории обслуживания автомобилей без использования бэкенда. Все данные хранятся локально на устройстве.

## Основные функции

### 1. Управление автомобилями

#### Добавление автомобиля
- **Местоположение:** Профиль → "Мой гараж" → "Добавить"
- **Возможности:**
  - Выбор марки из списка (Chery, Geely, Haval, Changan, Exeed и др.)
  - Выбор модели
  - Указание года выпуска
  - Ввод VIN-кода (опционально)
  - Ввод госномера (опционально)
  - Указание пробега (опционально)
- **Сохранение:** Данные сохраняются в SharedPreferences автоматически
- **Восстановление:** При перезапуске приложения все автомобили загружаются автоматически

#### Просмотр автомобиля
- Отображение основных данных (марка, модель, год, госномер)
- Текущий пробег
- Быстрый доступ к истории обслуживания
- Возможность удаления автомобиля (удаляются все связанные записи)

#### Редактирование данных
- Обновление пробега
- Изменение VIN или госномера

### 2. Записи о расходах и обслуживании

#### Типы записей
- **Топливо** (Fuel) - запись о заправке
- **Обслуживание** (Maintenance) - плановое ТО
- **Мойка** (Wash) - автомойка
- **Ремонт** (Repair) - неплановый ремонт
- **Страховка** (Insurance) - ОСАГО, КАСКО
- **Запчасти** (Parts) - покупка запчастей
- **Диагностика** (Diagnostics) - компьютерная диагностика
- **Шины** (Tires) - шиномонтаж, хранение шин
- **Другое** (Other) - прочие расходы

#### Поля записи
- Название (обязательно)
- Дата (обязательно)
- Пробег (обязательно)
- Сумма (обязательно)
- Категория (обязательно)
- Место проведения (опционально)
- Виды работ (опционально, для обслуживания)
- Комментарий (опционально)
- Фото чека (опционально)
- Дополнительные фото (опционально)

#### Фото в записях
Приложение поддерживает прикрепление фотографий к записям:
- Выбор фото из галереи
- Съёмка фото камерой
- Автоматическое сохранение в локальном хранилище приложения
- Отображение в деталях записи

**Техническая реализация:**
- Используется пакет `image_picker`
- Фото сохраняются в `{appDir}/photos/`
- Путь к фото сохраняется в модели `Expense`
- Максимальное разрешение: 1920x1080
- Качество сжатия: 80%

### 3. Документы

#### Типы документов
- **СТС** - Свидетельство о регистрации ТС
- **ПТС** - Паспорт транспортного средства
- **Водительское удостоверение** - категория, сроки действия
- **ОСАГО** - страховка гражданской ответственности
- **Диагностическая карта** - техосмотр
- **КАСКО** - страховка от ущерба

#### Возможности
- Добавление документов с фото (передняя и задняя сторона)
- Отслеживание сроков действия
- Уведомления об истекающих документах
- Фиксация организации и номера документа

### 4. Аналитика расходов

#### Периоды анализа
- Месяц
- 3 месяца
- Год
- Всё время

#### Виды аналитики
- Общая сумма расходов
- Расходы по категориям
- График расходов по месяцам
- Средний расход
- Количество записей
- Детализация по отдельной категории

### 5. Уведомления

#### Типы уведомлений
- **Напоминания о ТО** - за 7 дней до плановой даты
- **Напоминания о пробеге** - при достижении определённого пробега
- **Общие уведомления** - важные события приложения

#### Настройка
Уведомления настраиваются в:
- Профиль → Настройки → Уведомления

**Техническая реализация:**
- Пакет `flutter_local_notifications`
- Пакет `timezone` для точного планирования
- Локальные уведомления (без интернета)

### 6. Управление данными

#### Экспорт данных
Поддерживаемые форматы:
- **JSON** - полный экспорт всех данных (авто, расходы, документы, профиль)
  - Подходит для бэкапов
  - Можно импортировать обратно
- **PDF** - отчёт в виде PDF-документа
  - Красивое форматирование
  - Таблицы с данными
  - Можно отправить по email или распечатать

#### Импорт данных
- Загрузка из JSON-файла
- Восстановление всех данных из бэкапа
- Замена текущих данных импортированными

#### Резервные копии
- Автоматическое создание бэкапов (опционально)
- Ручное создание бэкапа
- Сохранение в локальном хранилище
- Возможность поделиться бэкапом

#### Очистка данных
- Очистка кэша приложений
- Удаление всех данных (опасная зона)
- Подтверждение удаления

### 7. Профиль пользователя

#### Личные данные
- Имя (обязательно)
- Город (обязательно)
- Email (опционально)
- Телефон (опционально)
- Фото профиля (опционально)

#### Редактирование профиля
- Изменение имени и города
- Добавление контактной информации
- Загрузка фото профиля
- Сохранение в SharedPreferences

### 8. Настройки приложения

#### Безопасность
- Изменение пароля (эмуляция, т.к. нет бэкенда)
- Биометрический вход (отображение)
- Двухфакторная аутентификация (информация)
- Управление активными сессиями

#### Язык
- Переключение между русским и английским
- Сохранение выбора в SharedPreferences
- Перезагрузка интерфейса на выбранном языке
- Локализация основных элементов

#### Приложение
- Уведомления (вкл/выкл)
- Тёмная тема (эмуляция переключения)
- Автоматическое резервное копирование

### 9. Помощь и поддержка

#### FAQ
- Категоризированные вопросы и ответы
- Поиск по вопросам
- Расширяемые карточки

#### Связь с поддержкой
- Email: support@servicebook.ru
- Телефон: 8-800-123-45-67
- Форма обратной связи
- Чат (эмуляция)

### 10. Юридическая информация

- Политика конфиденциальности
- Условия использования
- О приложении
- Лицензия

## Архитектура приложения

### Хранение данных
Все данные хранятся локально с использованием `SharedPreferences`:

- **Автомобили:** ключ `my_cars_list_v2`
- **Расходы:** ключ `expenses_list`
- **Документы:** ключ `documents_list`
- **Профиль:** ключ `user_profile_v2`
- **Язык:** ключ `app_locale`
- **Аутентификация:** ключ `is_authenticated`

### Модели данных

#### Car
```dart
{
  id: String,
  brand: String,
  model: String,
  year: String,
  vin: String?,
  plate: String?,
  addedDate: DateTime,
  mileage: int?
}
```

#### Expense
```dart
{
  id: String,
  carId: String,
  title: String,
  date: DateTime,
  mileage: int,
  amount: double,
  category: ExpenseCategory,
  place: String?,
  workTypes: List<String>,
  comment: String?,
  hasReceipt: bool,
  receiptPhotoPath: String?,
  photoPaths: List<String>,
  isConfirmed: bool,
  createdAt: DateTime
}
```

#### Document
```dart
{
  id: String,
  type: DocumentType,
  title: String,
  number: String?,
  issueDate: DateTime?,
  expiryDate: DateTime?,
  status: DocumentStatus,
  organization: String?,
  additionalData: Map?,
  createdAt: DateTime,
  updatedAt: DateTime
}
```

#### UserProfile
```dart
{
  name: String,
  city: String,
  email: String?,
  phone: String?,
  photoPath: String?,
  updatedAt: DateTime?
}
```

### Сервисы приложения

#### CarStorage
- CRUD операции для всех данных
- Загрузка и сохранение в SharedPreferences
- Статистика и аналитика
- Экспорт/импорт данных

#### PhotoService
- Выбор фото из галереи
- Съёмка фото камерой
- Сохранение фото в локальное хранилище
- Удаление фото

#### NotificationService
- Инициализация системы уведомлений
- Планирование напоминаний
- Отправка немедленных уведомлений
- Отмена уведомлений

#### LocaleProvider
- Управление языком приложения
- Сохранение выбора языка
- Уведомление об изменениях

### Навигация

#### Основные экраны
- `MainScreen` - нижняя навигация с 4 вкладками
- `DashboardScreen` - главная (статистика и быстрые действия)
- `HomeScreen` - список автомобилей
- `PartnersScreen` - карта партнёров
- `UserProfileScreen` - профиль и настройки

#### Дополнительные экраны
- `AddCarScreen` - добавление автомобиля
- `CarDetailScreen` - детали автомобиля
- `AddServiceScreen` - добавление записи
- `AllRecordsScreen` - все записи
- `DocumentsScreen` - документы
- `SettingsScreen` - общие настройки
- И другие экраны настроек

## Ограничения офлайн-режима

### Нет бэкенда = следующие ограничения:

1. **Данные не синхронизируются**
   - Если удалить приложение, данные будут потеряны
   - Нет возможности восстановить без бэкапа
   - Нельзя использовать на нескольких устройствах

2. **Нет удалённой аутентификации**
   - Пароль хранится локально (эмуляция)
   - Нет реальной защиты данных
   - Биометрия работает только на текущем устройстве

3. **Уведомления ограничены**
   - Работают только при запущенном приложении (Android)
   - Нет push-уведомлений с сервера
   - Планирование только локальное

4. **Нет аналитики использования**
   - Не собирается статистика использования
   - Нет отчётов для разработчика
   - Нельзя отследить ошибки на устройствах пользователей

### Плюсы офлайн-режима:

1. **Приватность**
   - Все данные остаются на устройстве
   - Не отправляются на сервер
   - Полный контроль над своими данными

2. **Скорость**
   - Мгновенный отклик интерфейса
   - Нет задержек сети
   - Работает без интернета

3. **Простота**
   - Не нужно регистрироваться
   - Нет сложной настройки
   - Начать работу можно сразу

## Рекомендации для пользователей

### Регулярно делайте бэкапы
- Настройка → Резервные копии → Создать сейчас
- Сохраняйте бэкап в облачное хранилище
- Делайте бэкап перед важными изменениями

### Следите за сроками действия документов
- Проверяйте документы раз в месяц
- Настройте уведомления за 30 дней до истечения
- Обновляйте данные вовремя

### Ведите регулярные записи
- Записывайте все расходы сразу после событий
- Добавляйте фото чеков
- Проверяйте пробег при обслуживании

### Используйте экспорт данных
- Регулярно экспортируйте в PDF
- Делайте отчёты по расходам
- Сохраняйте важные данные

---

**Версия:** 1.0.0
**Дата:** Февраль 2025
